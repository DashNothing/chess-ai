(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{29:function(t,r,e){},33:function(t,r,e){"use strict";e.r(r);var a,n,o=e(0),i=e.n(o),u=e(21),l=e.n(u),c=(e(29),e(7)),s=e(6),h=e(1),f=e(8);!function(t){t[t.King=0]="King",t[t.Queen=1]="Queen",t[t.Rook=2]="Rook",t[t.Bishop=3]="Bishop",t[t.Knight=4]="Knight",t[t.Pawn=5]="Pawn"}(a||(a={})),function(t){t[t.White=0]="White",t[t.Black=1]="Black"}(n||(n={}));for(var d=e(5),v=e(22),b=e(23),S=e(24),g=[8,-8,-1,1,7,-7,9,-9],p=[[]],k=[],q=[[]],m=[[]],w=[[]],O=[[]],j=function(t){var r=Math.floor(t/8),e=t-8*r,a=7-r,n=r,o=e,i=7-e;p[t]=[],p[t][0]=a,p[t][1]=n,p[t][2]=o,p[t][3]=i,p[t][4]=Math.min(a,o),p[t][5]=Math.min(n,i),p[t][6]=Math.min(a,i),p[t][7]=Math.min(n,o);for(var u=0;u<4;u++)for(var l=g[u],c=0;c<p[t][u];c++){var s=t+l*(c+1);k.push({fromSquare:t,toSquare:s})}var h=[];g.forEach((function(a){var n=t+a;if(n>=0&&n<64){var o=Math.floor(n/8),i=n-8*o;1===Math.max(Math.abs(e-i),Math.abs(r-o))&&h.push(n)}})),q[t]=h;var f=[];[15,17,-17,-15,10,-6,6,-10].forEach((function(a){var n=t+a;if(n>=0&&n<64){var o=Math.floor(n/8),i=n-8*o;2===Math.max(Math.abs(e-i),Math.abs(r-o))&&f.push(n)}})),m[t]=f;var d=[],v=[];e>0&&(r<7&&d.push(t+7),r>0&&v.push(t-9)),e<7&&(r<7&&d.push(t+9),r>0&&v.push(t-7)),w[t]=d,O[t]=v},y=0;y<64;y++)j(y);var M,P,B,W,L=function(t){var r=[],e=t.boardState.map((function(t,r){return[t,r]}));e=e.filter((function(r){var e=Object(s.a)(r,2),a=e[0];e[1];return(null===a||void 0===a?void 0:a.color)===t.currentPlayer}));var o=[8,-8,-1,1,7,-7,9,-9];return e.forEach((function(e){var i=Object(s.a)(e,2),u=i[0],l=i[1];switch(null===u||void 0===u?void 0:u.type){case a.Rook:for(var c=0;c<4;c++)for(var h=o[c],f=0;f<p[l][c];f++){var d,v,b=l+h*(f+1);if((null===(d=t.boardState[b])||void 0===d?void 0:d.color)===t.currentPlayer)break;if(r.push({fromSquare:l,toSquare:b}),null!=t.boardState[b]&&(null===(v=t.boardState[b])||void 0===v?void 0:v.color)!==t.currentPlayer)break}break;case a.Bishop:for(var S=4;S<8;S++)for(var g=o[S],k=0;k<p[l][S];k++){var j,y,M=l+g*(k+1);if((null===(j=t.boardState[M])||void 0===j?void 0:j.color)===t.currentPlayer)break;if(r.push({fromSquare:l,toSquare:M}),null!=t.boardState[M]&&(null===(y=t.boardState[M])||void 0===y?void 0:y.color)!==t.currentPlayer)break}break;case a.Queen:for(var P=0;P<8;P++)for(var B=o[P],W=0;W<p[l][P];W++){var L,R,K=l+B*(W+1);if((null===(L=t.boardState[K])||void 0===L?void 0:L.color)===t.currentPlayer)break;if(r.push({fromSquare:l,toSquare:K}),null!=t.boardState[K]&&(null===(R=t.boardState[K])||void 0===R?void 0:R.color)!==t.currentPlayer)break}break;case a.Knight:m[l].forEach((function(e){var a;(null===(a=t.boardState[e])||void 0===a?void 0:a.color)!==t.currentPlayer&&r.push({fromSquare:l,toSquare:e})}));break;case a.King:q[l].forEach((function(e){var a;(null===(a=t.boardState[e])||void 0===a?void 0:a.color)!==t.currentPlayer&&r.push({fromSquare:l,toSquare:e})}));var I=t.currentPlayer===n.White?t.castlingRights.whiteShort:t.castlingRights.blackShort,E=t.currentPlayer===n.White?t.castlingRights.whiteLong:t.castlingRights.blackLong;I&&null==t.boardState[l+1]&&null==t.boardState[l+2]&&r.push({fromSquare:l,toSquare:l+2}),E&&null==t.boardState[l-1]&&null==t.boardState[l-2]&&r.push({fromSquare:l,toSquare:l-2});break;case a.Pawn:var x=u.color===n.White?l+8:l-8;x>=0&&x<64&&null==t.boardState[x]&&r.push({fromSquare:l,toSquare:x});var C=u.color===n.White?l+16:l-16,_=u.color===n.White?1:6;Math.floor(l/8)===_&&null==t.boardState[x]&&null==t.boardState[C]&&r.push({fromSquare:l,toSquare:C});(u.color===n.White?w[l]:O[l]).forEach((function(e){var a;(null===(a=t.boardState[e])||void 0===a?void 0:a.color)!==t.currentPlayer&&null!=t.boardState[e]&&r.push({fromSquare:l,toSquare:e})}))}})),r},R=function(t){var r=[];return L(t).forEach((function(e){var n=K(t,e),o=L(n),i=n.boardState.indexOf(n.boardState.find((function(r){return(null===r||void 0===r?void 0:r.type)===a.King&&(null===r||void 0===r?void 0:r.color)===t.currentPlayer}))||null);o.some((function(t){return t.toSquare===i}))||r.push(e)})),r},K=function(t,r){var e,o,i,u,l,c=Object(S.a)(t.boardState),s=Object(b.a)({},t.castlingRights),h=null,f=t.halfMoveClock,d=t.fullMoves,v=c[r.fromSquare];c[r.fromSquare]=null,c[r.toSquare]=v;var g,p=!1;if(null!=t.boardState[r.toSquare]&&(p=!0),(null===(e=t.boardState[r.fromSquare])||void 0===e?void 0:e.type)===a.King){var k=I(r);if(k){var q=c[k.fromSquare];c[k.fromSquare]=null,c[k.toSquare]=q}t.currentPlayer===n.White?(s.whiteShort=!1,s.whiteLong=!1):(s.blackShort=!1,s.blackLong=!1)}((null===(o=t.boardState[r.fromSquare])||void 0===o?void 0:o.type)===a.Rook&&(t.currentPlayer===n.White?0===r.fromSquare?s.whiteLong=!1:7===r.fromSquare&&(s.whiteShort=!1):56===r.fromSquare?s.blackLong=!1:63===r.fromSquare&&(s.blackShort=!1)),(null===(i=t.boardState[r.toSquare])||void 0===i?void 0:i.type)===a.Rook)&&((null===(g=t.boardState[r.toSquare])||void 0===g?void 0:g.color)===n.White?0===r.toSquare?s.whiteLong=!1:7===r.toSquare&&(s.whiteShort=!1):56===r.toSquare?s.blackLong=!1:63===r.toSquare&&(s.blackShort=!1));if(t.currentPlayer===n.White?l=n.Black:(l=n.White,d++),(null===(u=t.boardState[r.fromSquare])||void 0===u?void 0:u.type)===a.Pawn){var m;if(2===Math.abs(Math.floor(r.fromSquare/8)-Math.floor(r.toSquare/8)))h=r.toSquare+8*((null===(m=t.boardState[r.fromSquare])||void 0===m?void 0:m.color)===n.White?-1:1);p=!0}return!1===p?f++:f=0,{boardState:c,castlingRights:s,currentPlayer:l,enPassantSquare:h,halfMoveClock:f,fullMoves:d}},I=function(t){return t.toSquare===t.fromSquare+2?{fromSquare:t.toSquare+1,toSquare:t.toSquare-1}:t.toSquare===t.fromSquare-2?{fromSquare:t.toSquare-2,toSquare:t.toSquare+1}:void 0},E=function(t,r){var e,o=0,i=(e={},Object(d.a)(e,a.Pawn,1),Object(d.a)(e,a.Bishop,3),Object(d.a)(e,a.Knight,3),Object(d.a)(e,a.Rook,5),Object(d.a)(e,a.Queen,9),Object(d.a)(e,a.King,900),e);return t.forEach((function(t){t&&(o+=i[t.type]*(t.color===n.White?1:-1))})),o*(r===n.White?1:-1)},x=f.a.div(M||(M=Object(c.a)(["\n\twidth: 500px;\n\theight: 500px;\n\tbackground-color: green;\n\tdisplay: grid;\n\tgrid-template-columns: repeat(8, 1fr);\n\tgrid-template-rows: repeat(8, 1fr);\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n"]))),C=f.a.div(P||(P=Object(c.a)(["\n\tposition: relative;\n\tdisplay: grid;\n\tplace-items: center;\n\tgrid-row: ",";\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: ",';\n\tcolor: black;\n\n\t::after {\n\t\tcontent: "";\n\t\tposition: absolute;\n\t\twidth: 85%;\n\t\theight: 85%;\n\t\tborder: 2px solid #5ca099;\n\t\topacity: ',';\n\t\tpointer-events: none;\n\t\tz-index: 2;\n\t}\n\n\t::before {\n\t\tcontent: "";\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-color: #a8c8a6;\n\t\topacity: ',";\n\t\tpointer-events: none;\n\t\tz-index: 0;\n\t}\n\n\tdiv {\n\t\twidth: 80%;\n\t\theight: 80%;\n\t\tbackground-image: ",";\n\t\tbackground-size: cover;\n\t\tz-index: 1;\n\t}\n"])),(function(t){return t.row}),(function(t){return t.isLight?"#f6edcd":"#f0cf8e"}),(function(t){return t.isMarkedLegal?1:0}),(function(t){return t.isMarkedLastMove?.9:0}),(function(t){return'url("chess-ai/images/'.concat(t.image,'.svg")')})),_=function(t){if(null==t)return"";switch(t.type){case a.King:return t.color===n.Black?"king_b":"king_w";case a.Queen:return t.color===n.Black?"queen_b":"queen_w";case a.Rook:return t.color===n.Black?"rook_b":"rook_w";case a.Bishop:return t.color===n.Black?"bishop_b":"bishop_w";case a.Knight:return t.color===n.Black?"knight_b":"knight_w";case a.Pawn:return t.color===n.Black?"pawn_b":"pawn_w";default:return""}},N=function(t){var r=t.gameState,e=t.lastMove,a=t.onMakeMove,n=Object(o.useState)([]),i=Object(s.a)(n,2),u=i[0],l=i[1],c=r.boardState.map((function(t,a){return Object(h.a)(C,{key:a,isLight:!(Math.floor(a/8)%2!==0?a%2!==0:a%2===0),row:8-Math.floor(a/8),image:_(t),onDragOver:function(t){return f(t)},onDrop:function(t){return b(t,a)},isMarkedLegal:u.includes(a),isMarkedLastMove:(null===e||void 0===e?void 0:e.fromSquare)===a||(null===e||void 0===e?void 0:e.toSquare)===a},t?t.color===r.currentPlayer?Object(h.a)("div",{draggable:!0,onDragStart:function(r){return d(r,a,_(t))},onDragEnd:function(t){return v(t)}}):Object(h.a)("div",null):null)})),f=function(t){t.preventDefault()},d=function(t,e,a){t.currentTarget.style.opacity="0",t.dataTransfer.setData("tilePosition",e.toString());var n=new Image;n.src="chess-ai/images/".concat(a,".svg"),t.dataTransfer.setDragImage(n,45,45);var o=R(r);l(o.filter((function(t){var r=t.fromSquare;t.toSquare;return r===e})).map((function(t){t.fromSquare;return t.toSquare})))},v=function(t){t.currentTarget.style.opacity="1",l([])},b=function(t,r){if(u.includes(r)){var e={fromSquare:parseInt(t.dataTransfer.getData("tilePosition")),toSquare:r};a(e),l([])}};return Object(h.a)(x,null,c)},Q=f.a.aside(B||(B=Object(c.a)(["\n\tpadding: 10px;\n\tbackground-color: rgba(0, 0, 0, 0.2);\n\n\tdiv {\n\t\tmargin: 10px 0;\n\t}\n"]))),D=function(t){var r=t.gameState;return Object(h.a)(Q,null,Object(h.a)("p",null,"Current player:"," ",r.currentPlayer===n.White?"white":"black"),Object(h.a)("div",null,Object(h.a)("h3",null,"Castling rights"),Object(h.a)("h4",null,"White"),Object(h.a)("p",null,"White king side: ",r.castlingRights.whiteShort.toString()),Object(h.a)("p",null,"White queen side: ",r.castlingRights.whiteLong.toString()),Object(h.a)("h4",null,"Black"),Object(h.a)("p",null,"Black king side: ",r.castlingRights.blackShort.toString()),Object(h.a)("p",null,"Black queen side: ",r.castlingRights.blackLong.toString())),Object(h.a)("div",null,Object(h.a)("p",null,"En passant square: ",function(t){for(var r=t.boardState,e=t.currentPlayer,o=t.castlingRights,i=t.enPassantSquare,u=t.halfMoveClock,l=t.fullMoves,c="",s=function(t){var r="";if(null==t)return r;switch(t.type){case a.Pawn:r="p";break;case a.Rook:r="r";break;case a.Knight:r="n";break;case a.Bishop:r="b";break;case a.Queen:r="q";break;case a.King:r="k"}return t.color===n.White&&(r=r.toUpperCase()),r},h=7;h>=0;h--){for(var f=0,d=0;d<8;d++)null==r[d+8*h]?f++:(f>0&&(c+=f.toString()),c+=s(r[d+8*h]),f=0);f>0&&(c+=f.toString()),0!==h&&(c+="/")}return c+=" ",c+=e===n.White?"w":"b",c+=" ",c+=o.whiteShort?"K":"",c+=o.whiteLong?"Q":"",c+=o.blackShort?"k":""," "===(c+=o.blackLong?"q":"")[c.length-1]&&(c+="-"),c+=" ",c+=null==i?"-":String.fromCharCode(i-8*Math.floor(i/8)+65)+(Math.floor(i/8)+1),c+=" ",c+=u+" "+l}(r).split(" ")[3])),Object(h.a)("div",null,Object(h.a)("p",null,"50 move rule counter: ",r.halfMoveClock)),Object(h.a)("div",null,Object(h.a)("p",null,"Full moves: ",r.fullMoves)),Object(h.a)("p",null,"Material advantage:"," ",E(r.boardState,n.White)))},T=function(t){var r=0,e=function t(e,a){if(r++,0===a)return E(e.boardState,e.currentPlayer);var n=Number.NEGATIVE_INFINITY;return L(e).forEach((function(r){var o=-t(K(e,r),a-1);o>n&&(n=o)})),n},a=[],n=Number.POSITIVE_INFINITY,o=L(t);if(0!==o.length){var i;i=Date.now(),o.forEach((function(r){var o=e(K(t,r),3);o<=n&&(n=o,a.push({move:r,score:o}))})),a=a.filter((function(t){t.move;return t.score===n}));var u=Date.now()-i;if(console.log("Checking "+r+" moves"),console.log("That took "+u+"ms"),0!==a.length)return a[Math.floor(Math.random()*a.length)].move}else console.log("Game over")};var z=f.a.main(W||(W=Object(c.a)(["\n\tdisplay: grid;\n\tgrid-template-columns: 1fr 3fr 1fr;\n\tpadding: 40px;\n"]))),F=function(){var t=Object(o.useState)(function(t){var r,e,o,i=[],u={whiteShort:!1,whiteLong:!1,blackShort:!1,blackLong:!1},l=null,c=function(t){switch(t.toLowerCase()){case"p":return a.Pawn;case"r":return a.Rook;case"n":return a.Knight;case"b":return a.Bishop;case"q":return a.Queen;case"k":default:return a.King}},s=t.split(" "),h=s[0],f=0,d=7,b=Object(v.a)(h);try{for(b.s();!(o=b.n()).done;){var S=o.value;if("/"===S)f=0,d--;else if(isNaN(parseInt(S))){var g={type:c(S),color:S===S.toUpperCase()?n.White:n.Black};i[f+8*d]=g,f++}else{for(var p=0;p<parseInt(S);p++)i[f+p+8*d]=null;f+=parseInt(S)}}}catch(y){b.e(y)}finally{b.f()}r="w"===s[1]?n.White:n.Black;var k=s[2];k.includes("K")&&(u.whiteShort=!0),k.includes("Q")&&(u.whiteLong=!0),k.includes("k")&&(u.blackShort=!0),k.includes("q")&&(u.blackLong=!0);var q=s[3];if("-"!==q){var m=q[0],w=q[1];l=m.charCodeAt(0)-65+8*parseInt(w)}var O=s[4];e=parseInt(O);var j=s[5];return{boardState:i,castlingRights:u,currentPlayer:r,enPassantSquare:l,halfMoveClock:e,fullMoves:parseInt(j)}}("rnbqkbnr/pp1ppppp/8/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R b KQkq - 1 2 ")),r=Object(s.a)(t,2),e=r[0],i=r[1],u=Object(o.useState)(null),l=Object(s.a)(u,2),c=l[0],f=l[1];Object(o.useEffect)((function(){e.currentPlayer===n.Black&&function(){var t=T(e);t&&d(t)}()}),[e]);var d=function(t){var r=K(e,t);i(r),f(t)};return Object(h.a)(z,null,Object(h.a)(D,{gameState:e}),Object(h.a)(N,{gameState:e,lastMove:c,onMakeMove:d}))},A=e(19);l.a.render(Object(A.jsx)(i.a.StrictMode,{children:Object(A.jsx)(F,{})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.7fa04d81.chunk.js.map