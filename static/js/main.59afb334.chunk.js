(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{31:function(t,r,e){},36:function(t,r,e){"use strict";e.r(r);var a,n,o=e(1),i=e.n(o),u=e(25),c=e.n(u),l=(e(31),e(4)),s=e(10),f=e.n(s),h=e(16),b=e(5),d=e(0),v=e(6);!function(t){t[t.King=0]="King",t[t.Queen=1]="Queen",t[t.Rook=2]="Rook",t[t.Bishop=3]="Bishop",t[t.Knight=4]="Knight",t[t.Pawn=5]="Pawn"}(a||(a={})),function(t){t[t.White=0]="White",t[t.Black=1]="Black"}(n||(n={}));for(var S=e(8),g=e(26),p=e(11),k=e(23),m=[8,-8,-1,1,7,-7,9,-9],q=[[]],j=[],O=[[]],y=[[]],w=[[]],P=[[]],M=function(t){var r=Math.floor(t/8),e=t-8*r,a=7-r,n=r,o=e,i=7-e;q[t]=[],q[t][0]=a,q[t][1]=n,q[t][2]=o,q[t][3]=i,q[t][4]=Math.min(a,o),q[t][5]=Math.min(n,i),q[t][6]=Math.min(a,i),q[t][7]=Math.min(n,o);for(var u=0;u<4;u++)for(var c=m[u],l=0;l<q[t][u];l++){var s=t+c*(l+1);j.push({fromSquare:t,toSquare:s})}var f=[];m.forEach((function(a){var n=t+a;if(n>=0&&n<64){var o=Math.floor(n/8),i=n-8*o;1===Math.max(Math.abs(e-i),Math.abs(r-o))&&f.push(n)}})),O[t]=f;var h=[];[15,17,-17,-15,10,-6,6,-10].forEach((function(a){var n=t+a;if(n>=0&&n<64){var o=Math.floor(n/8),i=n-8*o;2===Math.max(Math.abs(e-i),Math.abs(r-o))&&h.push(n)}})),y[t]=h;var b=[],d=[];e>0&&(r<7&&b.push(t+7),r>0&&d.push(t-9)),e<7&&(r<7&&b.push(t+9),r>0&&d.push(t-7)),w[t]=b,P[t]=d},x=0;x<64;x++)M(x);var B,W,R,L,K,I,C=function(t){var r=[],e=t.boardState.map((function(t,r){return[t,r]}));e=e.filter((function(r){var e=Object(b.a)(r,2),a=e[0];e[1];return(null===a||void 0===a?void 0:a.color)===t.currentPlayer}));var o=[8,-8,-1,1,7,-7,9,-9];return e.forEach((function(e){var i=Object(b.a)(e,2),u=i[0],c=i[1];switch(null===u||void 0===u?void 0:u.type){case a.Rook:for(var l=0;l<4;l++)for(var s=o[l],f=0;f<q[c][l];f++){var h,d,v=c+s*(f+1);if((null===(h=t.boardState[v])||void 0===h?void 0:h.color)===t.currentPlayer)break;if(r.push({fromSquare:c,toSquare:v}),null!=t.boardState[v]&&(null===(d=t.boardState[v])||void 0===d?void 0:d.color)!==t.currentPlayer)break}break;case a.Bishop:for(var S=4;S<8;S++)for(var g=o[S],p=0;p<q[c][S];p++){var k,m,j=c+g*(p+1);if((null===(k=t.boardState[j])||void 0===k?void 0:k.color)===t.currentPlayer)break;if(r.push({fromSquare:c,toSquare:j}),null!=t.boardState[j]&&(null===(m=t.boardState[j])||void 0===m?void 0:m.color)!==t.currentPlayer)break}break;case a.Queen:for(var M=0;M<8;M++)for(var x=o[M],B=0;B<q[c][M];B++){var W,R,L=c+x*(B+1);if((null===(W=t.boardState[L])||void 0===W?void 0:W.color)===t.currentPlayer)break;if(r.push({fromSquare:c,toSquare:L}),null!=t.boardState[L]&&(null===(R=t.boardState[L])||void 0===R?void 0:R.color)!==t.currentPlayer)break}break;case a.Knight:y[c].forEach((function(e){var a;(null===(a=t.boardState[e])||void 0===a?void 0:a.color)!==t.currentPlayer&&r.push({fromSquare:c,toSquare:e})}));break;case a.King:O[c].forEach((function(e){var a;(null===(a=t.boardState[e])||void 0===a?void 0:a.color)!==t.currentPlayer&&r.push({fromSquare:c,toSquare:e})}));var K=t.currentPlayer===n.White?t.castlingRights.whiteShort:t.castlingRights.blackShort,I=t.currentPlayer===n.White?t.castlingRights.whiteLong:t.castlingRights.blackLong;K&&null==t.boardState[c+1]&&null==t.boardState[c+2]&&r.push({fromSquare:c,toSquare:c+2}),I&&null==t.boardState[c-1]&&null==t.boardState[c-2]&&r.push({fromSquare:c,toSquare:c-2});break;case a.Pawn:var C=u.color===n.White?c+8:c-8;C>=0&&C<64&&null==t.boardState[C]&&r.push({fromSquare:c,toSquare:C});var _=u.color===n.White?c+16:c-16,E=u.color===n.White?1:6;Math.floor(c/8)===E&&null==t.boardState[C]&&null==t.boardState[_]&&r.push({fromSquare:c,toSquare:_});(u.color===n.White?w[c]:P[c]).forEach((function(e){var a;(null===(a=t.boardState[e])||void 0===a?void 0:a.color)!==t.currentPlayer&&null!=t.boardState[e]&&r.push({fromSquare:c,toSquare:e})}))}})),r},_=function(t){var r=[];return C(t).forEach((function(e){var n=E(t,e),o=C(n),i=n.boardState.indexOf(n.boardState.find((function(r){return(null===r||void 0===r?void 0:r.type)===a.King&&(null===r||void 0===r?void 0:r.color)===t.currentPlayer}))||null);o.some((function(t){return t.toSquare===i}))||r.push(e)})),r},E=function(t,r){var e,o,i,u,c=Object(k.a)(t.boardState),l=Object(p.a)({},t.castlingRights),s=t.currentPlayer,f=null,h=t.halfMoveClock,b=t.fullMoves,d=c[r.fromSquare];c[r.fromSquare]=null,c[r.toSquare]=d;var v,S=!1;if(null!=t.boardState[r.toSquare]&&(S=!0),(null===(e=t.boardState[r.fromSquare])||void 0===e?void 0:e.type)===a.King){var g=D(r);if(g){var m=c[g.fromSquare];c[g.fromSquare]=null,c[g.toSquare]=m}t.currentPlayer===n.White?(l.whiteShort=!1,l.whiteLong=!1):(l.blackShort=!1,l.blackLong=!1)}((null===(o=t.boardState[r.fromSquare])||void 0===o?void 0:o.type)===a.Rook&&(t.currentPlayer===n.White?0===r.fromSquare?l.whiteLong=!1:7===r.fromSquare&&(l.whiteShort=!1):56===r.fromSquare?l.blackLong=!1:63===r.fromSquare&&(l.blackShort=!1)),(null===(i=t.boardState[r.toSquare])||void 0===i?void 0:i.type)===a.Rook)&&((null===(v=t.boardState[r.toSquare])||void 0===v?void 0:v.color)===n.White?0===r.toSquare?l.whiteLong=!1:7===r.toSquare&&(l.whiteShort=!1):56===r.toSquare?l.blackLong=!1:63===r.toSquare&&(l.blackShort=!1));if(Q(r,t.boardState)?t.currentPlayer==n.Black&&(c=N(Object(p.a)(Object(p.a)({},t),{},{boardState:c}),r.toSquare,a.Queen).boardState,s=n.White,b++):t.currentPlayer===n.White?s=n.Black:(s=n.White,b++),(null===(u=t.boardState[r.fromSquare])||void 0===u?void 0:u.type)===a.Pawn){var q;if(2===Math.abs(Math.floor(r.fromSquare/8)-Math.floor(r.toSquare/8)))f=r.toSquare+8*((null===(q=t.boardState[r.fromSquare])||void 0===q?void 0:q.color)===n.White?-1:1);S=!0}return!1===S?h++:h=0,{boardState:c,castlingRights:l,currentPlayer:s,enPassantSquare:f,halfMoveClock:h,fullMoves:b}},D=function(t){return t.toSquare===t.fromSquare+2?{fromSquare:t.toSquare+1,toSquare:t.toSquare-1}:t.toSquare===t.fromSquare-2?{fromSquare:t.toSquare-2,toSquare:t.toSquare+1}:void 0},Q=function(t,r){var e;if((null===(e=r[t.fromSquare])||void 0===e?void 0:e.type)==a.Pawn){var o,i;if((null===(o=r[t.fromSquare])||void 0===o?void 0:o.color)==n.White&&7==Math.floor(t.toSquare/8))return!0;if((null===(i=r[t.fromSquare])||void 0===i?void 0:i.color)==n.Black&&0==Math.floor(t.toSquare/8))return!0}return!1},N=function(t,r,e){var a=Object(k.a)(t.boardState),o=t.currentPlayer,i=t.fullMoves;return null!=a[r]&&(a[r]={color:a[r].color,type:e}),t.currentPlayer===n.White?o=n.Black:(o=n.White,i++),Object(p.a)(Object(p.a)({},t),{},{boardState:a,currentPlayer:o,fullMoves:i})},T=function(t,r){var e,o=0,i=(e={},Object(S.a)(e,a.Pawn,1),Object(S.a)(e,a.Bishop,3),Object(S.a)(e,a.Knight,3),Object(S.a)(e,a.Rook,5),Object(S.a)(e,a.Queen,9),Object(S.a)(e,a.King,900),e);return t.forEach((function(t){t&&(o+=i[t.type]*(t.color===n.White?1:-1))})),o*(r===n.White?1:-1)},z=v.a.div(B||(B=Object(l.a)(["\n\twidth: 500px;\n\theight: 500px;\n\tbackground-color: green;\n\tdisplay: grid;\n\tgrid-template-columns: repeat(8, 1fr);\n\tgrid-template-rows: repeat(8, 1fr);\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n"]))),Y=v.a.div(W||(W=Object(l.a)(["\n\tposition: relative;\n\tdisplay: grid;\n\tplace-items: center;\n\tgrid-row: ",";\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: ",';\n\tcolor: black;\n\n\t::after {\n\t\tcontent: "";\n\t\tposition: absolute;\n\t\twidth: 85%;\n\t\theight: 85%;\n\t\tborder: 2px solid #5ca099;\n\t\topacity: ',';\n\t\tpointer-events: none;\n\t\tz-index: 2;\n\t}\n\n\t::before {\n\t\tcontent: "";\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-color: #a8c8a6;\n\t\topacity: ',";\n\t\tpointer-events: none;\n\t\tz-index: 0;\n\t}\n\n\tdiv {\n\t\twidth: 80%;\n\t\theight: 80%;\n\t\tbackground-image: ",";\n\t\tbackground-size: cover;\n\t\tz-index: 1;\n\t}\n"])),(function(t){return t.row}),(function(t){return t.isLight?"#f6edcd":"#f0cf8e"}),(function(t){return t.isMarkedLegal?1:0}),(function(t){return t.isMarkedLastMove?.9:0}),(function(t){return'url("'.concat("/chess-ai","/images/").concat(t.image,'.svg")')})),F=function(t){if(null==t)return"";switch(t.type){case a.King:return t.color===n.Black?"king_b":"king_w";case a.Queen:return t.color===n.Black?"queen_b":"queen_w";case a.Rook:return t.color===n.Black?"rook_b":"rook_w";case a.Bishop:return t.color===n.Black?"bishop_b":"bishop_w";case a.Knight:return t.color===n.Black?"knight_b":"knight_w";case a.Pawn:return t.color===n.Black?"pawn_b":"pawn_w";default:return""}},A=function(t){var r=t.gameState,e=t.lastMove,a=t.onMakeMove,n=Object(o.useState)([]),i=Object(b.a)(n,2),u=i[0],c=i[1],l=r.boardState.map((function(t,a){return Object(d.a)(Y,{key:a,isLight:!(Math.floor(a/8)%2!==0?a%2!==0:a%2===0),row:8-Math.floor(a/8),image:F(t),onDragOver:function(t){return s(t)},onDrop:function(t){return v(t,a)},isMarkedLegal:u.includes(a),isMarkedLastMove:(null===e||void 0===e?void 0:e.fromSquare)===a||(null===e||void 0===e?void 0:e.toSquare)===a},t?t.color===r.currentPlayer?Object(d.a)("div",{draggable:!0,onDragStart:function(r){return f(r,a,F(t))},onDragEnd:function(t){return h(t)}}):Object(d.a)("div",null):null)})),s=function(t){t.preventDefault()},f=function(t,e,a){t.currentTarget.style.opacity="0",t.dataTransfer.setData("tilePosition",e.toString());var n=new Image;n.src="".concat("/chess-ai","/images/").concat(a,".svg"),t.dataTransfer.setDragImage(n,45,45);var o=_(r);c(o.filter((function(t){var r=t.fromSquare;t.toSquare;return r===e})).map((function(t){t.fromSquare;return t.toSquare})))},h=function(t){t.currentTarget.style.opacity="1",c([])},v=function(t,r){if(u.includes(r)){var e={fromSquare:parseInt(t.dataTransfer.getData("tilePosition")),toSquare:r};a(e),c([])}};return Object(d.a)(z,null,l)},G=v.a.aside(R||(R=Object(l.a)(["\n\tpadding: 10px;\n\tbackground-color: rgba(0, 0, 0, 0.2);\n\n\tdiv {\n\t\tmargin: 10px 0;\n\t}\n"]))),J=function(t){var r=t.gameState;return Object(d.a)(G,null,Object(d.a)("p",null,"Current player:"," ",r.currentPlayer===n.White?"white":"black"),Object(d.a)("div",null,Object(d.a)("h3",null,"Castling rights"),Object(d.a)("h4",null,"White"),Object(d.a)("p",null,"White king side: ",r.castlingRights.whiteShort.toString()),Object(d.a)("p",null,"White queen side: ",r.castlingRights.whiteLong.toString()),Object(d.a)("h4",null,"Black"),Object(d.a)("p",null,"Black king side: ",r.castlingRights.blackShort.toString()),Object(d.a)("p",null,"Black queen side: ",r.castlingRights.blackLong.toString())),Object(d.a)("div",null,Object(d.a)("p",null,"En passant square: ",function(t){for(var r=t.boardState,e=t.currentPlayer,o=t.castlingRights,i=t.enPassantSquare,u=t.halfMoveClock,c=t.fullMoves,l="",s=function(t){var r="";if(null==t)return r;switch(t.type){case a.Pawn:r="p";break;case a.Rook:r="r";break;case a.Knight:r="n";break;case a.Bishop:r="b";break;case a.Queen:r="q";break;case a.King:r="k"}return t.color===n.White&&(r=r.toUpperCase()),r},f=7;f>=0;f--){for(var h=0,b=0;b<8;b++)null==r[b+8*f]?h++:(h>0&&(l+=h.toString()),l+=s(r[b+8*f]),h=0);h>0&&(l+=h.toString()),0!==f&&(l+="/")}return l+=" ",l+=e===n.White?"w":"b",l+=" ",l+=o.whiteShort?"K":"",l+=o.whiteLong?"Q":"",l+=o.blackShort?"k":""," "===(l+=o.blackLong?"q":"")[l.length-1]&&(l+="-"),l+=" ",l+=null==i?"-":String.fromCharCode(i-8*Math.floor(i/8)+65)+(Math.floor(i/8)+1),l+=" ",l+=u+" "+c}(r).split(" ")[3])),Object(d.a)("div",null,Object(d.a)("p",null,"50 move rule counter: ",r.halfMoveClock)),Object(d.a)("div",null,Object(d.a)("p",null,"Full moves: ",r.fullMoves)),Object(d.a)("p",null,"Material advantage:"," ",T(r.boardState,n.White)))},U=function(){var t=Object(h.a)(f.a.mark((function t(r){var e,a,n,o,i,u,c,l;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=0,a=function t(r,a){if(e++,0===a)return T(r.boardState,r.currentPlayer);var n=Number.NEGATIVE_INFINITY;return _(r).forEach((function(e){var o=-t(E(r,e),a-1);o>n&&(n=o)})),n},n=[],o=Number.POSITIVE_INFINITY,0!==(i=_(r)).length){t.next=8;break}return console.log("Game over"),t.abrupt("return",Promise.resolve(void 0));case 8:if(u=Date.now(),i.forEach((function(t){var e=a(E(r,t),3);e<=o&&(o=e,n.push({move:t,score:e}))})),n=n.filter((function(t){t.move;return t.score===o})),c=Date.now(),l=c-u,console.log("Checking "+e+" moves"),console.log("That took "+l+"ms"),0!==n.length){t.next=17;break}return t.abrupt("return",Promise.resolve(void 0));case 17:return t.abrupt("return",Promise.resolve(n[Math.floor(Math.random()*n.length)].move));case 18:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}(),V=Object(d.b)(L||(L=Object(l.a)(["\n\t0% {\n\t\ttransform: translateY(200px);\n\t\topacity: 0;\n\t}\n\t100% {\n\t\ttransform: translateY(0px);\n\t\topacity: 1;\n\t}\n"]))),H=v.a.div(K||(K=Object(l.a)(["\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\ttransform: translate(-50%, -50%);\n\tdisplay: flex;\n\tflex-direction: row;\n\tcolumn-gap: 10px;\n\n\tbutton {\n\t\tpadding: 10px;\n\t\tbackground-color: #fff;\n\t\tborder-radius: 100%;\n\t\tbox-shadow: 0px 4px 16px rgba(0, 0, 0, 0.2);\n\t\topacity: 0;\n\t\tanimation: "," 0.4s;\n\t\tanimation-fill-mode: forwards;\n\n\t\timg {\n\t\t\tdisplay: block;\n\t\t\twidth: 35px;\n\t\t\theight: 35px;\n\t\t\tobject-fit: contain;\n\t\t}\n\t}\n"])),V),X=function(t){t.x,t.y;var r=t.isShowing,e=t.onSelect;return Object(d.a)("div",null,1==r&&Object(d.a)(H,null,Object(d.a)("button",{style:{animationDelay:"0s"},onClick:function(t){return e(a.Queen)}},Object(d.a)("img",{src:"".concat("/chess-ai","/images/queen_w.svg")})),Object(d.a)("button",{style:{animationDelay:"0.1s"},onClick:function(t){return e(a.Rook)}},Object(d.a)("img",{src:"".concat("/chess-ai","/images/rook_w.svg")})),Object(d.a)("button",{style:{animationDelay:"0.2s"},onClick:function(t){return e(a.Bishop)}},Object(d.a)("img",{src:"".concat("/chess-ai","/images/bishop_w.svg")})),Object(d.a)("button",{style:{animationDelay:"0.3s"},onClick:function(t){return e(a.Knight)}},Object(d.a)("img",{src:"".concat("/chess-ai","/images/knight_w.svg")}))))};var Z=v.a.main(I||(I=Object(l.a)(["\n\tdisplay: grid;\n\tgrid-template-columns: 1fr 3fr 1fr;\n\tpadding: 40px;\n"]))),$=function(){var t=Object(o.useState)(function(t){var r,e,o,i=[],u={whiteShort:!1,whiteLong:!1,blackShort:!1,blackLong:!1},c=null,l=function(t){switch(t.toLowerCase()){case"p":return a.Pawn;case"r":return a.Rook;case"n":return a.Knight;case"b":return a.Bishop;case"q":return a.Queen;case"k":default:return a.King}},s=t.split(" "),f=s[0],h=0,b=7,d=Object(g.a)(f);try{for(d.s();!(o=d.n()).done;){var v=o.value;if("/"===v)h=0,b--;else if(isNaN(parseInt(v))){var S={type:l(v),color:v===v.toUpperCase()?n.White:n.Black};i[h+8*b]=S,h++}else{for(var p=0;p<parseInt(v);p++)i[h+p+8*b]=null;h+=parseInt(v)}}}catch(w){d.e(w)}finally{d.f()}r="w"===s[1]?n.White:n.Black;var k=s[2];k.includes("K")&&(u.whiteShort=!0),k.includes("Q")&&(u.whiteLong=!0),k.includes("k")&&(u.blackShort=!0),k.includes("q")&&(u.blackLong=!0);var m=s[3];if("-"!==m){var q=m[0],j=m[1];c=q.charCodeAt(0)-65+8*parseInt(j)}var O=s[4];e=parseInt(O);var y=s[5];return{boardState:i,castlingRights:u,currentPlayer:r,enPassantSquare:c,halfMoveClock:e,fullMoves:parseInt(y)}}("rnbqkbnr/pp1ppppp/8/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R b KQkq - 1 2 ")),r=Object(b.a)(t,2),e=r[0],i=r[1],u=Object(o.useState)(null),c=Object(b.a)(u,2),l=c[0],s=c[1],v=Object(o.useState)(!1),S=Object(b.a)(v,2),p=S[0],k=S[1],m=Object(o.useState)(null),q=Object(b.a)(m,2),j=q[0],O=q[1];Object(o.useEffect)((function(){var t=function(){var t=Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:U(e).then((function(t){console.log("Negamax move : "+t),t&&y(t)}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();e.currentPlayer===n.Black&&t()}),[e]);var y=function(t){var r=E(e,t);e.currentPlayer==r.currentPlayer&&(O(t.toSquare),k(!0)),i(r),s(t)};return Object(d.a)(Z,null,Object(d.a)(J,{gameState:e}),Object(d.a)(A,{gameState:e,lastMove:l,onMakeMove:y}),Object(d.a)(X,{x:0,y:0,isShowing:p,onSelect:function(t){if(null!=j){var r=N(e,j,t);i(r),k(!1)}}}))},tt=e(22);c.a.render(Object(tt.jsx)(i.a.StrictMode,{children:Object(tt.jsx)($,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.59afb334.chunk.js.map